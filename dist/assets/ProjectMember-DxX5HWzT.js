import{f as z,m as O,n as W,a5 as j,o as $,r as o,a as e,j as s,G as i,a6 as Q,q as P,t as M,a7 as F,d as q,B as w,p as U,y as V,b as v,c as B,a8 as G,x as J,z as K,s as k,H as X,J as L,K as H,Q as Z,U as Y,V as ee,W as te,X as ne,Z as ae,_ as re,a9 as oe}from"./vendor-DSVVCEiu.js";import{S as le}from"./styles-k6wuRl1O.js";import{a as se,g as ie,D as ce,b as de}from"./index-Di7kcznu.js";const he=c=>{const{fetchEmployees:d,onClose:b}=c,{id:I}=z(),t=O({initialValues:{Emp_Id:null,Role_Id:null,Degesination:""},validationSchema:W({Emp_Id:j().required("Employee is required"),Role_Id:j().required("Role is required"),Degesination:$().required("Designation is required")}),onSubmit:async r=>{try{const{Emp_Id:a,Role_Id:p,Degesination:n}=r,h=await se(Number(I),Number(a),Number(p),n);console.log(h),h&&h.success?(console.log("Success:",h.message),d(),b()):t.setFieldError("Emp_Id",h.message||"Unexpected response format. Please try again.")}catch(a){console.error("Complete Error Object:",a)}}}),[A,f]=o.useState([]),[N,_]=o.useState(["Developer","Tester","DB","Devops","BA"]),[u,m]=o.useState(!0),[y,E]=o.useState(null),[g,x]=o.useState(1),[C,R]=o.useState(!0),[S,T]=o.useState("");o.useEffect(()=>{(async()=>{m(!0),E(null);try{const a=await ie(g,S);f(p=>[...p,...a.data]),R(a.data.length>0)}catch(a){E(a.message)}finally{m(!1)}})()},[g,S]);const D=r=>{r.currentTarget.scrollHeight===r.currentTarget.scrollTop+r.currentTarget.clientHeight&&C&&!u&&x(p=>p+1)};return e(w,{component:"form",onSubmit:t.handleSubmit,sx:{display:"flex",flexDirection:"column",gap:2,width:"30em"},children:s(i,{container:!0,xs:12,spacing:2,children:[e(i,{item:!0,xs:12,sm:6,children:e(Q,{options:A,getOptionLabel:r=>r.Employee_name,onChange:(r,a)=>{t.setFieldValue("Emp_Id",a?a.Emp_Id:null)},onBlur:t.handleBlur,onInputChange:(r,a)=>{T(a),f([]),x(1)},renderInput:r=>e(P,{...r,label:"Select Employee",variant:"outlined",error:t.touched.Emp_Id&&!!t.errors.Emp_Id,helperText:t.touched.Emp_Id&&t.errors.Emp_Id}),loading:u,noOptionsText:u?"Loading...":"No options",ListboxProps:{onScroll:D}})}),e(i,{item:!0,xs:12,sm:6,children:s(M,{fullWidth:!0,size:"small",children:[s(P,{select:!0,label:"Role",id:"Role_Id",name:"Role_Id",value:t.values.Role_Id||"",onChange:t.handleChange,onBlur:t.handleBlur,error:t.touched.Role_Id&&!!t.errors.Role_Id,children:[e("option",{value:2,children:"Team Lead"}),e("option",{value:3,children:"Member"})]}),e(F,{error:t.touched.Role_Id&&!!t.errors.Role_Id,children:t.touched.Role_Id&&t.errors.Role_Id})]})}),e(i,{item:!0,xs:12,children:s(M,{fullWidth:!0,size:"small",children:[e(P,{select:!0,label:"Designation",id:"Degesination",name:"Degesination",value:t.values.Degesination||"",onChange:t.handleChange,onBlur:t.handleBlur,error:t.touched.Degesination&&!!t.errors.Degesination,children:N.map((r,a)=>e("option",{value:r,children:r},a))}),t.touched.Degesination&&t.errors.Degesination&&e(F,{error:!0,children:t.errors.Degesination})]})}),e(i,{item:!0,xs:12,children:e(q,{color:"primary",variant:"contained",type:"submit",children:"Register"})})]})})},ue=({open:c,onClose:d,fetchEmployees:b})=>s(K,{open:c,onClose:d,children:[s(i,{xs:12,container:!0,spacing:2,paddingTop:2,justifyContent:"space-between",sx:{display:"flex"},children:[e(i,{children:e(U,{sx:{paddingLeft:"40px",color:"primary.main",fontWeight:"bold",fontSize:"1.5em"},children:"Add New Member"})}),e(i,{children:e(V,{children:e(v,{title:"Close",sx:{color:"red"},children:e(B,{children:e(G,{onClick:()=>d(!1),sx:{fontSize:"1.4em"}})})})})})]}),e(J,{children:e(he,{fetchEmployees:b,onClose:d})})]}),l=k(X)(({theme:c})=>({[`&.${L.head}`]:{backgroundColor:"#f26729",color:"white",padding:"1em 8px"},[`&.${L.body}`]:{fontSize:12,padding:"6px 8px"}})),me=k(H)(({theme:c})=>({"&:nth-of-type(odd)":{backgroundColor:c.palette.action.hover},"&:last-child td, &:last-child th":{border:0}})),fe=()=>{const{id:c}=z(),[d,b]=o.useState([]),[I,t]=o.useState(!1),[A,f]=o.useState(!0),[N,_]=o.useState(null),[u,m]=o.useState(0),[y,E]=o.useState(5),[g,x]=o.useState(""),[C,R]=o.useState(0),S=()=>{t(!0)},T=(n=!1)=>{t(!1)},D=async()=>{f(!0),_(null);try{const n=await de(Number(c),u+1,y,g);b(n.data),R(n.total)}catch(n){_(n.message)}finally{f(!1)}};o.useEffect(()=>{D()},[c,u,y,g]);const r=(n,h)=>{m(h)},a=n=>{E(parseInt(n.target.value,10)),m(0)};return e(ce,{children:s(w,{sx:{width:"auto",overflow:"auto",paddingLeft:2,paddingRight:2},children:[e(i,{container:!0,spacing:2,children:e(i,{item:!0,xs:12,padding:2,sx:{marginTop:"1.4em"},children:s(w,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e(i,{children:e(le,{value:g,onChange:n=>{x(n.target.value),m(0)},placeholder:"Search by Employee Name",size:"small"})}),e(i,{children:e(q,{variant:"contained",color:"primary",onClick:S,children:"Add New Member"})}),e(ue,{open:I,onClose:n=>T(n),fetchEmployees:D})]})})}),e(Z,{component:Y,children:s(ee,{sx:{minWidth:700},"aria-label":"customized table",children:[e(te,{children:s(H,{children:[e(l,{children:"S.No"}),e(l,{align:"center",children:"Emp Id"}),e(l,{align:"center",children:"Project Name"}),e(l,{align:"center",children:"Employee Name"}),e(l,{align:"center",children:"Role"}),e(l,{align:"center",children:"Designation"}),e(l,{align:"center",children:"Actions"})]})}),e(ne,{children:d==null?void 0:d.map((n,h)=>s(me,{children:[e(l,{component:"th",scope:"row",children:u*y+h+1}),e(l,{align:"center",children:n.Emp_Id}),e(l,{align:"center",children:n.Project_Name}),e(l,{align:"center",children:n.Employee_name}),e(l,{align:"center",children:n.Role_Name}),e(l,{align:"center",children:n.Degesination}),s(l,{align:"center",children:[e(v,{title:"Edit",placement:"top",children:e(B,{children:e(ae,{color:"blue"})})}),e(v,{title:"Delete",placement:"top",children:e(B,{children:e(re,{color:"red"})})})]})]},n.Emp_Id))})]})}),e(oe,{component:"div",count:C,page:u,onPageChange:r,rowsPerPage:y,onRowsPerPageChange:a})]})})};export{fe as default};
